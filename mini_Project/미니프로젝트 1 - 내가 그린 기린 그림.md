
#API #javaScript #nodeJS #expressJS #백엔드 

# 미니프로젝트 진행

![](https://i.imgur.com/CzjLnx3.png)
[디자인 차수지FE]('https://github.com/IOTrue')

### 🧾 기획 : 내가 그린 그림을 문제로 내어 다른 사용자들이 맞추는 미니 캐쥬얼 게임
### 🎞️ 배포링크 : https://youtu.be/FEHbzJljdP0
### ⏱️ 개발 기간 : 23년 1월 13일 ~ 1월 20일 (8일)
#### 🛠️ 개발 스텍 : Node Js
### 📦 패키지 (pakeage.json)
		- aws-sdk : 아마존 AWS 인증 보안 관련
		- bcrypt : 비밀번호 암호화
		- cookie-parser : 쿠키 파싱 
		- cors : 프론트와 통신중 cors 문제 해결
		- dotenv : 민감정보에 대한 환경변수 설정
		- express : node express
		- express-rate-limit : 비정상적인 요청 방지 (악의적 공격)
		- express-sanitizer : XXS 위험 (오랫동안 업데이트 되지 않아 다른 방법 찾아야 함)
		- http2-express-bridge : node js에서 http2 패키지를 실행 시키기 위한 추가 패키
		- joi : 문자열 예외처리를 위한 검증 패키지
		- jsonwebtoken : JWT 토큰 인증 방식 사용 패키지
		- mkcert : SSL 인증서 발급을 위한 패키지
		- moment : 날짜 출력 방식 보조 패키지
		- multer : 이미지 처리 후 서버 전송을 위한 패키지
		- multer-s3 : multer 패키지 중 AWS S3 서버에 이미지 업로드를 위한 패키지
		- mysql2 : mySQL을 이용하기 위한 패키지
		- s3 : S3 서버사용을 위한 패키지
		- sequelize : node Js에서 ORM을 사용하기 위한 시퀄라이즈 패키지 
		- sequelize-cli : 시퀄라이즈 명령어를 통해 데이터 작업을 위한 패키지
		- swagger-autogen : swagger 패키지
		- swagger-ui-express : swagger ui 제작을 위한 패키지
### 📑 백엔드 프로젝트 구조
![400](https://i.imgur.com/xQ1FlCg.png)
### 📑ERD 구성
![](https://i.imgur.com/jwadYbJ.png)

### 🧾API 구성
 - https://docs.google.com/spreadsheets/d/1rrE9-8QeEqpbF8Klk7khSkzH3wmxrcfa2K53AArKNnU/edit#gid=0
### ⚙️ 프로젝트 백엔드 주요 기능
	1. 기본적 CRUD API 기능
	2. jwt 인증 및 사용자를 특정한 권한 관리
	3. 이미지 데이터 S3 업로드 처리
	4. SSL 보안 기능
	5. HTTP2 통신 적용

## 기능 및 트러블
1. CRUD 기능구현
- 프로젝트 시작 전 API명세서 작성으로 전달 데이터 양식 및 타입에 대한 사전 작업으로 인해
     데이터 양식으로 인한 트러블은 크게 발생하지 않음
- 사용자 정보 및 인증 / 게시글의 작성 조회 2가지 파트로 나누어 작업
- 스코프가 크지 않아 서버 구동까지 1일 소요

2.  인증 및 인가
트러블
	최초 jwt 토큰을 Cookie로 사용하려하였으나 서버에서 정상적으로 쿠키가 보내져 클라이언트 
	네트워크에서 확인이 가능했으나 쿠키가 다시 서버쪽으로 돌아오지 못하는 현상 발생 

해결 
	보안 통신(https) 환경에서만 쿠키에 대한 req, res가 가능하다는것을 알고, 헤더로 보내기로 결정
	이유 : 쿠키로 계속 보내려면 프론트엔드에서 SSL 인증을 설정해야하는데 local 환경에서 
			작업하면서 시간적으로 보안인증까지 거친 후 상호 https 통신으로 테스트할 수 있는 시간이 현저히 부족하여 헤더로 보내는 방법으로 테스트 및 서비스 구현

트러블
	로컬 환경에터 코드 작성 후 백엔드 서버 배포 후 프론트에서 데이터를 받아 처리하는 과정 중 
	유명한 CORS 에러 발생

해결
	이미 CORS에 대한 대략적인 상황 및 대처에 대해 공부하여, cors 모듈을 설치하여, 
	origin을 프론트엔드 서버로 설정, 토큰에 대한 키값 및 데이터 처리 실행
	 